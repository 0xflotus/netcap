# ________ ____  __ __  ______     
#  \___   // __ \|  |  \/  ___/    
#   /    /\  ___/|  |  /\___ \    
#  /_____ \\___  >____//____  >  
#        \/    \/           \/  
#                    Build System
#                          v0.8.4
#



# default language
language: bash

# globals for all commands
globals:

# command data
commands:
    
    # build the binary
    build:
        description: build project
        dependencies:
            - clean
        buildNumber: true
        exec: go build -o bin/netcap -i github.com/dreadl0ck/netcap/cmd

    # clean up the mess
    clean:
        description: clean up to prepare for build
        exec: rm -rf bin/*
    
    # perform install
    install:
        description: install to $PATH
        buildNumber: true
        help: Install the application to the default system location
        exec: go build -o $(go env GOPATH)/bin/netcap -i github.com/dreadl0ck/netcap/cmd

    # perform install
    install-netlabel:
        description: install to $PATH
        buildNumber: true
        help: Install the netlabel application to the default system location
        exec: go build -o $(go env GOPATH)/bin/netlabel -i github.com/dreadl0ck/netcap/label/cmd

    install-race:
        description: install race build to $PATH
        buildNumber: true
        help: Install the race build to the default system location
        exec: go build -race -o $(go env GOPATH)/bin/netcap -i github.com/dreadl0ck/netcap/cmd
        
    cloc:
        description: count lines of code
        exec: cloc --exclude-ext pb.go,py,rb cmd sensor server label types utils collector encoder netcap.go reader.go utils.go

    gen-proto:
        description: generate protocol buffers
        exec: protoc --go_out=types/. --ruby_out=types/ --python_out=types/ netcap.proto

    install-sensor:
        description: install to $PATH
        help: Install the netcap sensor to the default system location
        exec: go build -o $(go env GOPATH)/bin/netcap-sensor -i github.com/dreadl0ck/netcap/sensor

    install-server:
        description: install to $PATH
        help: Install the netcap server to the default system location
        exec: go build -o $(go env GOPATH)/bin/netcap-server -i github.com/dreadl0ck/netcap/server
    build-tf-neural:
        language: bash
        description: build tensorflow python script from jupyter notebook
        help:
        arguments:
        dependencies:
        outputs:
        exec: cd tensorflow && jupyter nbconvert --to script t81_558_class12_security.ipynb
